<div class="friends-container">

    <div class="friends-header">
        <h1 class="friends-title">Friend Requests</h1>

        <div class="friends-nav">
            <a asp-controller="Friends" asp-action="Index" class="friends-link">Friends</a>
            <a asp-controller="Friends" asp-action="not_friends_yet" class="friends-link">Suggested Friends</a>
        </div>
    </div>


    <!-- ========================= -->
    <!-- RECEIVED REQUESTS -->
    <!-- ========================= -->
    <h2 class="section-title">Received Requests</h2>
    <p>This page is now inactive.</p>

    <ul class="friends-list">
        @if ((ViewBag.ReceivedRequests as List<acebook.Models.FriendRequest>)?.Any() == true)
        {
            foreach (var req in (List<acebook.Models.FriendRequest>)ViewBag.ReceivedRequests)
            {
                var user = req.User;

                <li class="friend-item">

                    <div class="friend-info">
                        <div class="friend-header d-flex align-items-center">
                            <div class="profile-icon">@user?.Name?.FirstOrDefault()</div>
                            <a href="/users/@user?.Id">@user?.Name</a>

                        </div>

                        <span class="friend-email friend-email-offset">Wants to be friends!</span>
                    </div>

                    <div class="d-flex gap-2">
                        <form asp-action="AcceptRequest" method="post">
                            <input type="hidden" name="requestSenderId" value="@user?.Id" />
                            <input type="hidden" name="requestId" value="@req.Id" />
                            <button class="friend-add-btn" type="submit">Accept</button>
                        </form>

                        <form asp-action="RejectRequest" method="post">
                            <input type="hidden" name="requestId" value="@req.Id" />
                            <button class="friend-delete-btn" type="submit">Reject</button>
                        </form>
                    </div>

                </li>
            }
        }
        else
        {
            <li class="no-friends-placeholder">No requests received.</li>
        }
    </ul>



    <!-- ========================= -->
    <!-- SENT REQUESTS -->
    <!-- ========================= -->
    <h2 class="section-title mt-5">Sent Requests</h2>

    <ul class="friends-list">
        @if ((ViewBag.SentRequests as List<acebook.Models.FriendRequest>)?.Any() == true)
        {
            foreach (var sent in (List<acebook.Models.FriendRequest>)ViewBag.SentRequests)
            {
                var friend = sent.Friend;

                <li class="friend-item">

                    <div class="friend-info">
                        <div class="friend-header d-flex align-items-center">
                            <div class="profile-icon">@friend?.Name?.FirstOrDefault()</div>
                            <a href="/users/@friend?.Id">@friend?.Name</a>
                        </div>

                        <span class="friend-email friend-email-offset">@friend?.Email</span>
                    </div>

                    <form asp-action="RejectRequest" method="post">
                        <input type="hidden" name="requestId" value="@sent.Id" />
                        <button class="friend-delete-btn" type="submit">Cancel</button>
                    </form>

                </li>
            }
        }
        else
        {
            <li class="no-friends-placeholder">No pending sent requests.</li>
        }
    </ul>

</div>