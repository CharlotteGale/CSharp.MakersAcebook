@model acebook.Models.User
<div class="login-wrapper">
    <div class="login-page">
        <div class="login-left">
            <h1 class="brand-title">Acebook</h1>
            <p class="brand-tagline">Connect with friends and the world around you.</p>
        </div>

        <form asp-controller="Users" asp-action="Create" method="post" class="login-card" novalidate>

    <div class="mb-3">
        <input asp-for="Name" placeholder="Name" class="form-field" />
        <span asp-validation-for="Name" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <input asp-for="Email" placeholder="Email" class="form-field" />
        <span asp-validation-for="Email" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <input asp-for="Password" id="Password" type="password" placeholder="Password" class="form-field" />
        <div id="password-help" class="text-danger" style="margin-top: 6px;"></div>
        <span asp-validation-for="Password" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label asp-for="DateOfBirth" class="form-label">Date of Birth</label>
        <input asp-for="DateOfBirth" class="form-control form-field" type="date" />
        <span asp-validation-for="DateOfBirth" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <input id="signup-submit" type="submit" value="Create account" class="submit-btn">
    </div>
</form>

    </div>
</div>

<script>
  (function () {
    const passwordInput = document.getElementById("Password");
    const help = document.getElementById("password-help");
    const submit = document.getElementById("signup-submit");
    const form = passwordInput?.closest("form");

    if (!passwordInput || !help || !submit || !form) return;

    const msg = "Password must be at least 8 characters and include uppercase, lowercase, a number, and a symbol.";

    function isStrong(pw) {
      const minLen = pw.length >= 8;
      const hasLower = /[a-z]/.test(pw);
      const hasUpper = /[A-Z]/.test(pw);
      const hasDigit = /[0-9]/.test(pw);
      const hasSymbol = /[^a-zA-Z0-9]/.test(pw);
      return minLen && hasLower && hasUpper && hasDigit && hasSymbol;
    }

    function setPasswordMessage(pw, forceShow) {
      if (!forceShow && pw.length === 0) {
        help.textContent = "";
        return;
      }
      help.textContent = isStrong(pw) ? "" : msg;
    }

    function update(forceShow = false) {
      const pw = passwordInput.value || "";

      if (pw.length === 0) {
        submit.disabled = false;
        setPasswordMessage(pw, forceShow);
        return;
      }

      const ok = isStrong(pw);
      submit.disabled = !ok;
      setPasswordMessage(pw, forceShow);
    }

    passwordInput.addEventListener("input", () => update(false));

    form.addEventListener("submit", (e) => {
      const pw = passwordInput.value || "";

      if (pw.length === 0) {
          help.textContent = "";
          return;
      }


      if (!isStrong(pw)) {
        e.preventDefault();
        update(true);
      }
    });

    update(false);
  })();
</script>
